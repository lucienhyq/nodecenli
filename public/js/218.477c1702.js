"use strict";(self["webpackChunkp"]=self["webpackChunkp"]||[]).push([[218],{7712:function(e,t,i){i.d(t,{A:function(){return v}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"quillEditor"},[t("el-upload",{staticStyle:{display:"none"},attrs:{action:"http://localhost:3000/posts","list-type":"picture-card","on-success":e.handlePictureCardPreview,"on-remove":e.handleRemove}},[t("i",{staticClass:"el-icon-plus quilleditor_img"})]),t("div",[t("el-dialog",{staticStyle:{"margin-top":"1px"},attrs:{"close-on-click-modal":!1,width:"50%",title:"视频上传",visible:e.videoDialog.show,"append-to-body":""},on:{"update:visible":function(t){return e.$set(e.videoDialog,"show",t)}}},[t("el-tabs",{model:{value:e.videoDialog.activeName,callback:function(t){e.$set(e.videoDialog,"activeName",t)},expression:"videoDialog.activeName"}},[t("el-tab-pane",{attrs:{label:"添加视频链接",name:"first"}},[t("el-input",{attrs:{placeholder:"请输入视频链接",clearable:""},model:{value:e.videoDialog.videoLink,callback:function(t){e.$set(e.videoDialog,"videoLink",t)},expression:"videoDialog.videoLink"}}),t("el-button",{staticStyle:{margin:"20px 0px 0px 0px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addVideoLink(e.videoDialog.videoLink)}}},[e._v("添加 ")])],1),t("el-tab-pane",{attrs:{label:"本地视频上传",name:"second"}},[t("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.uploading,expression:"uploading"}],staticStyle:{"text-align":"center"},attrs:{drag:"",action:e.uploadUrl,accept:"video/*",data:e.videoFileData,"before-upload":e.onBeforeUploadVideo,"on-success":e.onSuccessVideo,"on-error":e.onErrorVideo,multiple:!1}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v(" 将文件拖到此处，或"),t("em",[e._v("点击上传")])])])],1)],1)],1)],1),t("quill-editor",{ref:"myTextEditor",attrs:{options:e.editorOption},on:{change:e.onEditorChange},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)},s=[],o=i(5771);const l=o.Quill.import("blots/block/embed"),r=o.Quill.import("formats/link"),n=["height","width"];class d extends l{static create(e){const t=super.create(e);return t.setAttribute("controls","controls"),t.setAttribute("type","video/mp4"),t.setAttribute("src",this.sanitize(e)),t.setAttribute("preload","metadata"),t}static formats(e){return n.reduce(((t,i)=>(e.hasAttribute(i)&&(t[i]=e.getAttribute(i)),t)),{})}static sanitize(e){return r.sanitize(e)}static value(e){return e.getAttribute("src")}format(e,t){n.indexOf(e)>-1?t?this.domNode.setAttribute(e,t):this.domNode.removeAttribute(e):super.format(e,t)}html(){const{video:e}=this.value();return`<a href="${e}">${e}</a>`}}d.blotName="video",d.className="ql-video",d.tagName="video";var c=d;class m{constructor(e,t={}){this.quill=e,this.handleDrop=this.handleDrop.bind(this),this.handlePaste=this.handlePaste.bind(this),this.quill.root.addEventListener("drop",this.handleDrop,!1),this.quill.root.addEventListener("paste",this.handlePaste,!1)}handleDrop(e){if(e.preventDefault(),e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files.length){if(document.caretRangeFromPoint){const t=document.getSelection(),i=document.caretRangeFromPoint(e.clientX,e.clientY);t&&i&&t.setBaseAndExtent(i.startContainer,i.startOffset,i.startContainer,i.startOffset)}this.readFiles(e.dataTransfer.files,this.insert.bind(this))}}handlePaste(e){e.clipboardData&&e.clipboardData.items&&e.clipboardData.items.length&&this.readFiles(e.clipboardData.items,(e=>{const t=this.quill.getSelection();t||setTimeout((()=>this.insert(e)),0)}))}insert(e){const t=(this.quill.getSelection()||{}).index||this.quill.getLength();this.quill.insertEmbed(t,"image",e,"user")}readFiles(e,t){[].forEach.call(e,(e=>{if(!e.type.match(/^image\/(gif|jpe?g|a?png|svg|webp|bmp|vnd\.microsoft\.icon)/i))return;const i=new FileReader;i.onload=e=>{t(e.target.result)};const a=e.getAsFile?e.getAsFile():e;a instanceof Blob&&i.readAsDataURL(a)}))}}o.Quill.register(c,!0),o.Quill.register("modules/imageDrop",m);var u={components:{quillEditor:o.quillEditor},data(){return{content:"",editorOption:null,videoDialog:{show:!1,activeName:"",videoLink:""},uploading:"",uploadUrl:"",videoFileData:{}}},methods:{onEditorChange({editor:e,html:t,text:i}){this.$emit("quillBlur",t)},handlePictureCardPreview(e){let t=this.$refs.myTextEditor.quill,i=t.getSelection().index;console.log(e),t.insertEmbed(i,"image",e.data),t.setSelection(i+1)},handleRemove(){},onBeforeUploadVideo(){},onSuccessVideo(){},onErrorVideo(){},addVideoLink(e){if(console.log(e),!e)return this.$message.error("请输入视频地址");this.videoDialog.show=!1;let t=this.$refs.myTextEditor.quill.savedRange,i=0;null!=t&&(i=t.index),this.$refs.myTextEditor.quill.insertEmbed(i,"video",e),this.$refs.myTextEditor.quill.setSelection(i+1)}},created(){const e=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["image","video"]];this.editorOption={theme:"snow",placeholder:"请输入正文",modules:{imageDrop:!0,toolbar:{container:e,handlers:{image:function(e){e?document.querySelector(".quilleditor_img").click():this.quill.format("image",!1)},video:e=>{this.videoDialog.show=!0}}}}}}},p=u,h=i(1656),f=(0,h.A)(p,a,s,!1,null,"090e30e2",null),v=f.exports},6218:function(e,t,i){i.r(t),i.d(t,{default:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"cardHome"},[t("div",{staticClass:"left"},[e._m(0),t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"150px"}},[t("el-form-item",{attrs:{label:"公司名称",required:""}},[t("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"输入公司名称"},model:{value:e.form.company_name,callback:function(t){e.$set(e.form,"company_name",t)},expression:"form.company_name"}})],1),t("el-form-item",{attrs:{label:"联系我们",required:""}},[t("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入联系电话"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),t("el-form-item",{attrs:{label:"公司地址",required:""}},[t("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"输入公司名称"},model:{value:e.form.company_address,callback:function(t){e.$set(e.form,"company_address",t)},expression:"form.company_address"}})],1),t("el-form-item",{attrs:{label:"公司发展历程",required:""}},[t("div",{staticClass:"addOption"},[t("el-button",{attrs:{type:"primary"},on:{click:e.add_dateHistory}},[e._v("添加")])],1),e._l(e.form.development_history,(function(i,a){return t("div",{key:a,staticClass:"historyList"},[t("el-input",{staticStyle:{width:"100px","margin-right":"10px"},attrs:{placeholder:"年份"},model:{value:i.date,callback:function(t){e.$set(i,"date",t)},expression:"item.date"}}),e._v(" - "),t("el-input",{staticStyle:{width:"250px","margin-left":"10px"},attrs:{placeholder:"年份简介(不超过20字)"},model:{value:i.desc,callback:function(t){e.$set(i,"desc",t)},expression:"item.desc"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"info"},on:{click:function(t){return e.delDateOption(a)}}},[e._v("删除")])],1)}))],2),t("el-form-item",{attrs:{label:"公司业务",required:""}},e._l(e.form.main_business,(function(i,a){return t("div",{key:a,staticClass:"historyList"},[t("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"业务称谓"},model:{value:i.text,callback:function(t){e.$set(i,"text",t)},expression:"item.text"}}),t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("el-switch",{staticStyle:{"margin-left":"15px","margin-right":"15px"},attrs:{"active-color":"#13ce66","inactive-color":"#999"},model:{value:i.show,callback:function(t){e.$set(i,"show",t)},expression:"item.show"}}),t("span",[e._v(e._s(i.show?"显示":"隐藏"))])],1)],1)})),0),t("el-form-item",{attrs:{label:"团队风采(轮播展示)"}},[t("div",{staticClass:"uoloadBox"},[t("div",{staticClass:"uoloadBox_show"},e._l(e.form.team_style,(function(e,i){return t("div",{key:i,staticClass:"imgShow"},[t("img",{attrs:{src:e,alt:""}})])})),0),t("div",{staticClass:"uoloadBox_add"},[e.tag?e._e():t("el-upload",{attrs:{"show-file-list":!1,action:"http://localhost:3000/card/cardUpload","list-type":"picture-card","on-success":e.handlePictureCardPreview,"on-remove":e.handleRemove}},[t("i",{staticClass:"el-icon-plus"})])],1)])]),t("el-form-item",{attrs:{label:"公司简介"}},[t("quillEditor",{ref:"quillChild",attrs:{contenInfo:e.form.contenRow,disabled:e.tag},on:{quillBlur:e.quillBlur}})],1)],1)],1),t("div",{staticClass:"rigth"},[t("div",{staticClass:"saveBtn",on:{click:e.save_Post}},[e._v("保存设置")])])])},s=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-main-title"},[t("div",{staticClass:"vue-main-title-left"}),t("div",{staticClass:"vue-main-title-content"},[e._v("卡片设置")])])}],o=(i(4114),i(7712)),l={data(){return{form:{company_name:"",company_address:"",contenRow:"",development_history:[],main_business:[],team_style:[],phone:""},tag:!1,info:[]}},components:{quillEditor:o.A},activated(){this.getData(),setTimeout((()=>{window.scrollTo(0,0)}),500)},methods:{quillBlur(e){this.form.contenRow=e},async save_Post(){let e={company_name:this.form.company_name,company_address:this.form.company_address,company_desc:this.form.contenRow,development_history:this.form.development_history,main_business:this.form.main_business,team_style:this.form.team_style,phone:this.form.phone},{data:t,msg:i,result:a}=await $http.post("card/setting/save",e,"获取中");a?this.$message.success(i):this.$message.error(i)},add_dateHistory(){this.form.development_history.push({date:"",desc:""})},add_main(){this.form.main_business.push({text:"",icon:""})},delDateMain(e){this.form.main_business.splice(e,1)},delDateOption(e){this.form.development_history.splice(e,1)},async getData(){let{data:e,msg:t,result:i}=await $http.post("card/card_Index",{},"获取中");i?e.data&&(this.form.company_name=e.data.company_name,this.form.company_address=e.data.company_address,this.form.development_history=e.data.development_history,this.form.contenRow=e.data.company_desc,this.form.main_business=e.data.main_business,this.form.team_style=e.data.team_style,this.$refs.quillChild.content=this.form.contenRow,this.form.phone=e.data.phone):this.$message.error(t)},handlePictureCardPreview(e){this.form.team_style.push(e.data)},handleRemove(e){console.log(e)}}},r=l,n=i(1656),d=(0,n.A)(r,a,s,!1,null,"39d983e0",null),c=d.exports}}]);
//# sourceMappingURL=218.477c1702.js.map