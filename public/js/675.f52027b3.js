"use strict";(self["webpackChunkp"]=self["webpackChunkp"]||[]).push([[675],{7712:function(t,e,i){i.d(e,{A:function(){return v}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"quillEditor"},[e("el-upload",{staticStyle:{display:"none"},attrs:{action:"http://localhost:3000/posts","list-type":"picture-card","on-success":t.handlePictureCardPreview,"on-remove":t.handleRemove}},[e("i",{staticClass:"el-icon-plus quilleditor_img"})]),e("div",[e("el-dialog",{staticStyle:{"margin-top":"1px"},attrs:{"close-on-click-modal":!1,width:"50%",title:"视频上传",visible:t.videoDialog.show,"append-to-body":""},on:{"update:visible":function(e){return t.$set(t.videoDialog,"show",e)}}},[e("el-tabs",{model:{value:t.videoDialog.activeName,callback:function(e){t.$set(t.videoDialog,"activeName",e)},expression:"videoDialog.activeName"}},[e("el-tab-pane",{attrs:{label:"添加视频链接",name:"first"}},[e("el-input",{attrs:{placeholder:"请输入视频链接",clearable:""},model:{value:t.videoDialog.videoLink,callback:function(e){t.$set(t.videoDialog,"videoLink",e)},expression:"videoDialog.videoLink"}}),e("el-button",{staticStyle:{margin:"20px 0px 0px 0px"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.addVideoLink(t.videoDialog.videoLink)}}},[t._v("添加 ")])],1),e("el-tab-pane",{attrs:{label:"本地视频上传",name:"second"}},[e("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.uploading,expression:"uploading"}],staticStyle:{"text-align":"center"},attrs:{drag:"",action:t.uploadUrl,accept:"video/*",data:t.videoFileData,"before-upload":t.onBeforeUploadVideo,"on-success":t.onSuccessVideo,"on-error":t.onErrorVideo,multiple:!1}},[e("i",{staticClass:"el-icon-upload"}),e("div",{staticClass:"el-upload__text"},[t._v(" 将文件拖到此处，或"),e("em",[t._v("点击上传")])])])],1)],1)],1)],1),e("quill-editor",{ref:"myTextEditor",attrs:{options:t.editorOption},on:{change:t.onEditorChange},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)},s=[],o=i(5771);const l=o.Quill.import("blots/block/embed"),r=o.Quill.import("formats/link"),n=["height","width"];class d extends l{static create(t){const e=super.create(t);return e.setAttribute("controls","controls"),e.setAttribute("type","video/mp4"),e.setAttribute("src",this.sanitize(t)),e.setAttribute("preload","metadata"),e}static formats(t){return n.reduce(((e,i)=>(t.hasAttribute(i)&&(e[i]=t.getAttribute(i)),e)),{})}static sanitize(t){return r.sanitize(t)}static value(t){return t.getAttribute("src")}format(t,e){n.indexOf(t)>-1?e?this.domNode.setAttribute(t,e):this.domNode.removeAttribute(t):super.format(t,e)}html(){const{video:t}=this.value();return`<a href="${t}">${t}</a>`}}d.blotName="video",d.className="ql-video",d.tagName="video";var c=d;class m{constructor(t,e={}){this.quill=t,this.handleDrop=this.handleDrop.bind(this),this.handlePaste=this.handlePaste.bind(this),this.quill.root.addEventListener("drop",this.handleDrop,!1),this.quill.root.addEventListener("paste",this.handlePaste,!1)}handleDrop(t){if(t.preventDefault(),t.dataTransfer&&t.dataTransfer.files&&t.dataTransfer.files.length){if(document.caretRangeFromPoint){const e=document.getSelection(),i=document.caretRangeFromPoint(t.clientX,t.clientY);e&&i&&e.setBaseAndExtent(i.startContainer,i.startOffset,i.startContainer,i.startOffset)}this.readFiles(t.dataTransfer.files,this.insert.bind(this))}}handlePaste(t){t.clipboardData&&t.clipboardData.items&&t.clipboardData.items.length&&this.readFiles(t.clipboardData.items,(t=>{const e=this.quill.getSelection();e||setTimeout((()=>this.insert(t)),0)}))}insert(t){const e=(this.quill.getSelection()||{}).index||this.quill.getLength();this.quill.insertEmbed(e,"image",t,"user")}readFiles(t,e){[].forEach.call(t,(t=>{if(!t.type.match(/^image\/(gif|jpe?g|a?png|svg|webp|bmp|vnd\.microsoft\.icon)/i))return;const i=new FileReader;i.onload=t=>{e(t.target.result)};const a=t.getAsFile?t.getAsFile():t;a instanceof Blob&&i.readAsDataURL(a)}))}}o.Quill.register(c,!0),o.Quill.register("modules/imageDrop",m);var u={components:{quillEditor:o.quillEditor},data(){return{content:"",editorOption:null,videoDialog:{show:!1,activeName:"",videoLink:""},uploading:"",uploadUrl:"",videoFileData:{}}},methods:{onEditorChange({editor:t,html:e,text:i}){this.$emit("quillBlur",e)},handlePictureCardPreview(t){let e=this.$refs.myTextEditor.quill,i=e.getSelection().index;console.log(t),e.insertEmbed(i,"image",t.data),e.setSelection(i+1)},handleRemove(){},onBeforeUploadVideo(){},onSuccessVideo(){},onErrorVideo(){},addVideoLink(t){if(console.log(t),!t)return this.$message.error("请输入视频地址");this.videoDialog.show=!1;let e=this.$refs.myTextEditor.quill.savedRange,i=0;null!=e&&(i=e.index),this.$refs.myTextEditor.quill.insertEmbed(i,"video",t),this.$refs.myTextEditor.quill.setSelection(i+1)}},created(){const t=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["image","video"]];this.editorOption={theme:"snow",placeholder:"请输入正文",modules:{imageDrop:!0,toolbar:{container:t,handlers:{image:function(t){t?document.querySelector(".quilleditor_img").click():this.quill.format("image",!1)},video:t=>{this.videoDialog.show=!0}}}}}}},p=u,h=i(1656),f=(0,h.A)(p,a,s,!1,null,"090e30e2",null),v=f.exports},8675:function(t,e,i){i.r(e),i.d(e,{default:function(){return c}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cardHome"},[e("div",{staticClass:"left"},[t._m(0),e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"150px"}},[e("el-form-item",{attrs:{label:"公司名称",required:""}},[e("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"输入公司名称"},model:{value:t.form.company_name,callback:function(e){t.$set(t.form,"company_name",e)},expression:"form.company_name"}})],1),e("el-form-item",{attrs:{label:"公司地址",required:""}},[e("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"输入公司名称"},model:{value:t.form.company_address,callback:function(e){t.$set(t.form,"company_address",e)},expression:"form.company_address"}})],1),e("el-form-item",{attrs:{label:"公司发展历程",required:""}},[e("div",{staticClass:"addOption"},[e("el-button",{attrs:{type:"primary"},on:{click:t.add_dateHistory}},[t._v("添加")])],1),t._l(t.form.development_history,(function(i,a){return e("div",{key:a,staticClass:"historyList"},[e("el-input",{staticStyle:{width:"100px","margin-right":"10px"},attrs:{placeholder:"年份"},model:{value:i.date,callback:function(e){t.$set(i,"date",e)},expression:"item.date"}}),t._v(" - "),e("el-input",{staticStyle:{width:"250px","margin-left":"10px"},attrs:{placeholder:"年份简介(不超过20字)"},model:{value:i.desc,callback:function(e){t.$set(i,"desc",e)},expression:"item.desc"}}),e("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"info"},on:{click:function(e){return t.delDateOption(a)}}},[t._v("删除")])],1)}))],2),e("el-form-item",{attrs:{label:"公司业务",required:""}},t._l(t.form.main_business,(function(i,a){return e("div",{key:a,staticClass:"historyList"},[e("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"业务称谓"},model:{value:i.text,callback:function(e){t.$set(i,"text",e)},expression:"item.text"}}),e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("el-switch",{staticStyle:{"margin-left":"15px","margin-right":"15px"},attrs:{"active-color":"#13ce66","inactive-color":"#999"},model:{value:i.show,callback:function(e){t.$set(i,"show",e)},expression:"item.show"}}),e("span",[t._v(t._s(i.show?"显示":"隐藏"))])],1)],1)})),0),e("el-form-item",{attrs:{label:"团队风采(轮播展示)"}},[e("div",{staticClass:"uoloadBox"},[e("div",{staticClass:"uoloadBox_show"},t._l(t.form.team_style,(function(t,i){return e("div",{key:i,staticClass:"imgShow"},[e("img",{attrs:{src:t,alt:""}})])})),0),e("div",{staticClass:"uoloadBox_add"},[t.tag?t._e():e("el-upload",{attrs:{"show-file-list":!1,action:"http://localhost:3000/card/cardUpload","list-type":"picture-card","on-success":t.handlePictureCardPreview,"on-remove":t.handleRemove}},[e("i",{staticClass:"el-icon-plus"})])],1)])]),e("el-form-item",{attrs:{label:"公司简介"}},[e("quillEditor",{ref:"quillChild",attrs:{contenInfo:t.form.contenRow,disabled:t.tag},on:{quillBlur:t.quillBlur}})],1)],1)],1),e("div",{staticClass:"rigth"},[e("div",{staticClass:"saveBtn",on:{click:t.save_Post}},[t._v("保存设置")])])])},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"vue-main-title"},[e("div",{staticClass:"vue-main-title-left"}),e("div",{staticClass:"vue-main-title-content"},[t._v("卡片设置")])])}],o=(i(4114),i(7712)),l={data(){return{form:{company_name:"",company_address:"",contenRow:"",development_history:[],main_business:[],team_style:[]},tag:!1,info:[]}},components:{quillEditor:o.A},activated(){this.getData()},methods:{quillBlur(t){this.form.contenRow=t},async save_Post(){let t={company_name:this.form.company_name,company_address:this.form.company_address,company_desc:this.form.contenRow,development_history:this.form.development_history,main_business:this.form.main_business,team_style:this.form.team_style},{data:e,msg:i,result:a}=await $http.post("card/setting/save",t,"获取中");a?this.$message.success(i):this.$message.error(i)},add_dateHistory(){this.form.development_history.push({date:"",desc:""})},add_main(){this.form.main_business.push({text:"",icon:""})},delDateMain(t){this.form.main_business.splice(t,1)},delDateOption(t){this.form.development_history.splice(t,1)},async getData(){let{data:t,msg:e,result:i}=await $http.post("card/card_Index",{},"获取中");i?t.data&&(this.form.company_name=t.data.company_name,this.form.company_address=t.data.company_address,this.form.development_history=t.data.development_history,this.form.contenRow=t.data.company_desc,this.form.main_business=t.data.main_business,this.form.team_style=t.data.team_style,this.$refs.quillChild.content=this.form.contenRow):this.$message.error(e)},handlePictureCardPreview(t){console.log(this.form.team_style,"wwwwwwwww"),this.form.team_style.push(t.data),console.log(this.form.team_style,"team_style")},handleRemove(t){console.log(t)}}},r=l,n=i(1656),d=(0,n.A)(r,a,s,!1,null,"5380b236",null),c=d.exports}}]);
//# sourceMappingURL=675.f52027b3.js.map